---
title: "p8105_hw2_lz3014"
auther: "Liqi Zhou"
date: 2024-10-02
output: github_document
---

```{r}
library(tidyverse)
library(readxl)
```

# problem1
### 1.Read, clean and convert the data
```{r}
NYC_subway <- read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv", 
                       na = c("NA",".",""))
NYC_subway_clean <- janitor::clean_names(NYC_subway) |>
  select(line, station_name, station_latitude, station_longitude, route1, route2, route3, route4, route5, route6, route7, route8, route9, route10, route11, entry, vending, entrance_type, ada) |>
  mutate(entry = case_match(entry, "YES" ~ TRUE, "NO" ~ FALSE))
NYC_subway_clean
```

### 2.Simple info about this dataset
This dataset contains various variabels related to subways in New York, including *line*, *station name*, *station latitude and longitude*, *routes*, *entry*, *ADA compliance* and so on. To clean the data, firstly, I imported the dataset and used `janitor::clean_names` function to clean up variable names. Then, I used `select` to retain the required variables. Finally, I used `case_match` function to convert the *entry* from character to a logical variable.

After data cleaning process, this data has `r nrow(NYC_subway_clean)` rows and `r ncol(NYC_subway_clean)` columns. These data are not tidy since from route1to route11 can be reduced to one variable. 

### 3.Answer 3 questions
- How many distinct stations are there?
```{r}
station_num <- distinct(NYC_subway_clean, line, station_name) |>
  nrow()
station_num
```

- How many stations are ADA compliant?
```{r}
ADA_station_num <- NYC_subway_clean |>
  filter(ada == TRUE) |>
  distinct(line, station_name) |>
  nrow()
ADA_station_num
```

- What proportion of station entrances / exits without vending allow entrance?
```{r}
ee_novend_en_num <- NYC_subway_clean |>
  filter(vending == "NO" & entry == TRUE) |>
  nrow()
proportion <- ee_novend_en_num/nrow(NYC_subway_clean)
proportion
```

### 4.Reformat data and 2 questions
```{r}
NYC_subway_clean <- NYC_subway_clean |>
  mutate(across(starts_with("route"), as.character))

NYC_subway_tidy <- 
  pivot_longer(
    NYC_subway_clean, 
    route1:route11, 
    names_to = "route_number", 
    names_prefix = "route", 
    values_to = "route_name"
  )
NYC_subway_tidy
```

- How many distinct stations serve the A train?
```{r}
A_station_num <- NYC_subway_tidy |>
  filter(route_name == "A") |>
  distinct(line, station_name) |>
  nrow()
A_station_num
```

- Of the stations that serve the A train, how many are ADA compliant?
```{r}
A_ADA_station_num <- NYC_subway_tidy |>
  filter(route_name == "A" & ada == TRUE) |>
  distinct(line, station_name) |>
  nrow()
A_ADA_station_num
```





