p8105_hw2_lz3014
================
2024-10-02

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(readxl)
```

# problem 1

### 1.Read, clean and convert the data

``` r
NYC_subway <- read_csv(file = "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv", 
                       na = c("NA",".",""))
```

    ## Rows: 1868 Columns: 32
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (22): Division, Line, Station Name, Route1, Route2, Route3, Route4, Rout...
    ## dbl  (8): Station Latitude, Station Longitude, Route8, Route9, Route10, Rout...
    ## lgl  (2): ADA, Free Crossover
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
NYC_subway_clean <- janitor::clean_names(NYC_subway) |>
  select(line, station_name, station_latitude, station_longitude, route1, route2, route3, route4, route5, route6, route7, route8, route9, route10, route11, entry, vending, entrance_type, ada) |>
  mutate(entry = case_match(entry, "YES" ~ TRUE, "NO" ~ FALSE))
NYC_subway_clean
```

    ## # A tibble: 1,868 × 19
    ##    line     station_name station_latitude station_longitude route1 route2 route3
    ##    <chr>    <chr>                   <dbl>             <dbl> <chr>  <chr>  <chr> 
    ##  1 4 Avenue 25th St                  40.7             -74.0 R      <NA>   <NA>  
    ##  2 4 Avenue 25th St                  40.7             -74.0 R      <NA>   <NA>  
    ##  3 4 Avenue 36th St                  40.7             -74.0 N      R      <NA>  
    ##  4 4 Avenue 36th St                  40.7             -74.0 N      R      <NA>  
    ##  5 4 Avenue 36th St                  40.7             -74.0 N      R      <NA>  
    ##  6 4 Avenue 45th St                  40.6             -74.0 R      <NA>   <NA>  
    ##  7 4 Avenue 45th St                  40.6             -74.0 R      <NA>   <NA>  
    ##  8 4 Avenue 45th St                  40.6             -74.0 R      <NA>   <NA>  
    ##  9 4 Avenue 45th St                  40.6             -74.0 R      <NA>   <NA>  
    ## 10 4 Avenue 53rd St                  40.6             -74.0 R      <NA>   <NA>  
    ## # ℹ 1,858 more rows
    ## # ℹ 12 more variables: route4 <chr>, route5 <chr>, route6 <chr>, route7 <chr>,
    ## #   route8 <dbl>, route9 <dbl>, route10 <dbl>, route11 <dbl>, entry <lgl>,
    ## #   vending <chr>, entrance_type <chr>, ada <lgl>

### 2.Simple info about this dataset

This dataset contains various variabels related to subways in New York,
including *line*, *station name*, *station latitude and longitude*,
*routes*, *entry*, *ADA compliance* and so on. To clean the data,
firstly, I imported the dataset and used `janitor::clean_names` function
to clean up variable names. Then, I used `select` to retain the required
variables. Finally, I used `case_match` function to convert the *entry*
from character to a logical variable.

After data cleaning process, this data has 1868 rows and 19 columns.
These data are not tidy since from route1to route11 can be reduced to
one variable.

### 3.Answer 3 questions

- How many distinct stations are there?

``` r
station_num <- distinct(NYC_subway_clean, line, station_name) |>
  nrow()
station_num
```

    ## [1] 465

- How many stations are ADA compliant?

``` r
ADA_station_num <- NYC_subway_clean |>
  filter(ada == TRUE) |>
  distinct(line, station_name) |>
  nrow()
ADA_station_num
```

    ## [1] 84

- What proportion of station entrances / exits without vending allow
  entrance?

``` r
ee_novend_en_num <- NYC_subway_clean |>
  filter(vending == "NO" & entry == TRUE) |>
  nrow()
proportion <- ee_novend_en_num/nrow(NYC_subway_clean)
proportion
```

    ## [1] 0.0369379

### 4.Reformat data and 2 questions

``` r
NYC_subway_clean <- NYC_subway_clean |>
  mutate(across(starts_with("route"), as.character))

NYC_subway_tidy <- 
  pivot_longer(
    NYC_subway_clean, 
    route1:route11, 
    names_to = "route_number", 
    names_prefix = "route", 
    values_to = "route_name"
  )
NYC_subway_tidy
```

    ## # A tibble: 20,548 × 10
    ##    line     station_name station_latitude station_longitude entry vending
    ##    <chr>    <chr>                   <dbl>             <dbl> <lgl> <chr>  
    ##  1 4 Avenue 25th St                  40.7             -74.0 TRUE  YES    
    ##  2 4 Avenue 25th St                  40.7             -74.0 TRUE  YES    
    ##  3 4 Avenue 25th St                  40.7             -74.0 TRUE  YES    
    ##  4 4 Avenue 25th St                  40.7             -74.0 TRUE  YES    
    ##  5 4 Avenue 25th St                  40.7             -74.0 TRUE  YES    
    ##  6 4 Avenue 25th St                  40.7             -74.0 TRUE  YES    
    ##  7 4 Avenue 25th St                  40.7             -74.0 TRUE  YES    
    ##  8 4 Avenue 25th St                  40.7             -74.0 TRUE  YES    
    ##  9 4 Avenue 25th St                  40.7             -74.0 TRUE  YES    
    ## 10 4 Avenue 25th St                  40.7             -74.0 TRUE  YES    
    ## # ℹ 20,538 more rows
    ## # ℹ 4 more variables: entrance_type <chr>, ada <lgl>, route_number <chr>,
    ## #   route_name <chr>

- How many distinct stations serve the A train?

``` r
A_station_num <- NYC_subway_tidy |>
  filter(route_name == "A") |>
  distinct(line, station_name) |>
  nrow()
A_station_num
```

    ## [1] 60

- Of the stations that serve the A train, how many are ADA compliant?

``` r
A_ADA_station_num <- NYC_subway_tidy |>
  filter(route_name == "A" & ada == TRUE) |>
  distinct(line, station_name) |>
  nrow()
A_ADA_station_num
```

    ## [1] 17

# Problem 2

### 1.Read and clean the Mr. Trash Wheel sheet

``` r
trash_wheel <- read_excel("./data/202409 Trash Wheel Collection Data.xlsx", 
                          skip = 1, 
                          sheet = "Mr. Trash Wheel", 
                          na = c("NA",".","")) |>
  janitor::clean_names()
```

    ## New names:
    ## • `` -> `...15`
    ## • `` -> `...16`

``` r
trash_wheel_clean <- trash_wheel |>
  filter(!is.na(dumpster)) |> 
  mutate(sports_balls = round(sports_balls) |>
           as.integer(), year = as.double(year)) |>
  mutate(trash_w = "mr.")
trash_wheel_clean
```

    ## # A tibble: 651 × 17
    ##    dumpster month  year date                weight_tons volume_cubic_yards
    ##       <dbl> <chr> <dbl> <dttm>                    <dbl>              <dbl>
    ##  1        1 May    2014 2014-05-16 00:00:00        4.31                 18
    ##  2        2 May    2014 2014-05-16 00:00:00        2.74                 13
    ##  3        3 May    2014 2014-05-16 00:00:00        3.45                 15
    ##  4        4 May    2014 2014-05-17 00:00:00        3.1                  15
    ##  5        5 May    2014 2014-05-17 00:00:00        4.06                 18
    ##  6        6 May    2014 2014-05-20 00:00:00        2.71                 13
    ##  7        7 May    2014 2014-05-21 00:00:00        1.91                  8
    ##  8        8 May    2014 2014-05-28 00:00:00        3.7                  16
    ##  9        9 June   2014 2014-06-05 00:00:00        2.52                 14
    ## 10       10 June   2014 2014-06-11 00:00:00        3.76                 18
    ## # ℹ 641 more rows
    ## # ℹ 11 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, sports_balls <int>, homes_powered <dbl>, x15 <lgl>,
    ## #   x16 <lgl>, trash_w <chr>

### 2.Import, clean, and organize the data for Professor Trash Wheel and Gwynnda, and combine this with the Mr. Trash Wheel dataset.

``` r
pro_trash_wheel <- read_excel("./data/202409 Trash Wheel Collection Data.xlsx", 
                              skip = 1, 
                              sheet = "Professor Trash Wheel", 
                              na = c("NA",".","")) |> 
  janitor::clean_names() |> 
  filter(!is.na(dumpster)) |>
  mutate(trash_w = "professor")
```

``` r
gwy_trash_wheel <- read_excel("./data/202409 Trash Wheel Collection Data.xlsx", 
                              skip = 1, 
                              sheet = "Gwynnda Trash Wheel", 
                              na = c("NA",".","")) |> 
  janitor::clean_names() |> 
  filter(!is.na(dumpster)) |>
  mutate(trash_w = "gwynnda")
```

``` r
trash_wheel_three <- bind_rows(trash_wheel_clean, pro_trash_wheel, gwy_trash_wheel)
```
